{% extends "admin/base.html" %}

{% block title %}Crawl Queue{% endblock %}

{% block content %}
<div class="container">
    <div class="header">
        <h1>Pale Blue Search Admin</h1>
        <div class="nav">
            <a href="/admin/">Dashboard</a>
            <a href="/admin/crawlers">Crawlers</a>
            <a href="/admin/seeds">Seeds</a>
            <a href="/admin/queue" class="active">Queue</a>
            <a href="/admin/history">History</a>
            <a href="/admin/analytics">Analytics</a>
            <a href="/admin/logout">Logout</a>
        </div>
    </div>

    <div class="card">
        <h2>Quick Add URL</h2>
        <p style="color: #999; margin-bottom: 12px; font-size: 0.9rem;">
            Add a URL directly to the crawl queue (temporary, not saved as a seed).
        </p>
        {% if success %}
        <p class="success">{{ success }}</p>
        {% endif %}
        {% if error %}
        <p class="error">{{ error }}</p>
        {% endif %}
        <form method="post" action="/admin/queue" class="form-row">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            <input type="url" name="url" placeholder="https://example.com/page" required>
            <button type="submit">Add to Queue</button>
        </form>
    </div>

    <div class="card">
        <h2>Crawl Queue (Top 50)</h2>
        <table>
            <thead><tr><th>URL</th><th>Score</th></tr></thead>
            <tbody>
                {% if queue_urls %}
                    {% for url, score in queue_urls %}
                    <tr>
                        <td style="max-width: 600px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="{{ url }}">{{ url }}</td>
                        <td>{{ "%.2f"|format(score) }}</td>
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr><td colspan="2">Queue is empty or Crawler unavailable</td></tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
